---
title: "04_describe"
author: "group22"
format:
  html:
    embed-resources: true
editor: visual
---

## Load data

```{r}
df_aug <- read_tsv("../data/03_dat_aug.tsv")
```

## Visualization

1.  **The distribution of BMI in the different age groups, including a comparison between smokers and non-smokers.**

```{r}
df_aug |> 
  ggplot(aes(x = BMI, y = Age_Range)) +
  geom_density_ridges(aes(fill = Age_Range) ,alpha=0.3) + 
  facet_wrap(~Smoking_Status)+
  labs(x = "BMI",
       y = "Age Group") +
  theme_minimal()+
  theme(legend.position = "none") +
  scale_fill_viridis_d() +
  labs(title = "BMI distribution over the different age groups", 
       subtitle = "A comparison between smokers and non-smokers")
```

As it is illustrated from the plot above, smoking status affects mostly the youngest age groups, namely 18-24 and 25-34, where it is shown that smokers have a generally higher BMI than the non-smokers. For the other age groups, the behavior is almost the same between smokers and non-smokers, so smoking doesn't appear as a main factor influencing BMI for individuals over 35. However, the general tendency is that BMI increases over the age, as it can be seen by the peak.

2.  **Comparison of BMI between income classes, divided into individuals with and without physical activity.**

```{r}
df_aug |> 
  ggplot(mapping = aes(x = BMI,
                       y = fct_relevel(Income_Class,"Poor","Average","Wealthy"))) +
  geom_boxplot(aes(fill = Physically_Active),
               outlier.shape = NA) +
  xlim(0,60) +
  xlab("BMI") +
  ylab("Income Class") +
  theme(legend.position = "none") +
  labs(title = "Comparison of BMI between different income classes", 
       subtitle = "Red: No Physical Activity, Blue: Physical Activity")
```

3.  **Distribution of habits among individuals between genders**

```{r}
df_aug |> 
  ggplot(mapping = aes(x = Habits,
                       fill = Sex)) +
  geom_bar(position = position_dodge()) +
  facet_wrap(~Diabetes_Status) +
  ylab("Count") +
  labs(title = "The distribution of habits among individuals", 
       subtitle = "Comparison between 2 genders")
```
