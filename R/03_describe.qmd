---
title: "03_describe"
author: "group22"
format:
  html:
    embed-resources: true
editor: visual
---

### Load libraries and data

```{r}
library("tidyverse")
library("ggridges")
library("RColorBrewer")

df_cleaned <- read.table(file = "../data/02_dat_clean.tsv", sep = "\t", header = TRUE)

# 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
```

## Rename binary variables

### Smoking

Changing the smokers variable from binary format to categorical. The value "0" which indicates non-smokers is changed to "Non-Smoker", and the value "1" changed to "Smoker" respectively.

```{r}
df_cleaned <-
  df_cleaned |> 
  mutate(Smoking_Status = case_when(
    Smoker == 0 ~ "Non-Smoker",
    Smoker == 1 ~ "Smoker"
  ))
```

### Age

The age was changed from the 13-level age category to the corresponding range values.

```{r}
df_cleaned <-
  df_cleaned |> 
  mutate(Age_Range = case_when(
    Age == 1 ~ "18-24",
    Age == 2 | Age == 3 ~ "25-34",
    Age == 4 | Age == 5 ~ "35-44",
    Age == 6 | Age == 7 | Age == 8 ~ "45-59",
    Age == 9 | Age == 10 | Age == 11 ~ "60-74",
    Age == 12 | Age == 13 ~ "75-"))
```

### Income

Income variable changed from a scale from 1-9 to three classes: Poor, Average and Wealthy.

```{r}
df_cleaned <-
  df_cleaned |> 
  mutate(Income_Class = case_when(
    Income <= 3 ~ "Poor",
    Income  > 3 & Income <= 6 ~ "Average",
    Income > 6 ~ "Wealthy"))
```

### Physical Activity

```{r}
df_cleaned <-
  df_cleaned |> 
  mutate(PhysActivity = case_when(
    PhysActivity == 0 ~ "No",
    PhysActivity == 1 ~ "Yes"))
```

## Plot

```{r}
df_cleaned |> 
  ggplot(aes(x = BMI, y = Age_Range)) +
  geom_density_ridges(aes(fill = Age_Range) ,alpha=0.3) + 
  facet_wrap(~Smoking_Status)+
  labs(x = "BMI",
       y = "Age Group") +
  theme_minimal()+
  theme(legend.position = "none") +
  scale_fill_viridis_d() +
  labs(title = "BMI distribution over the different age groups", 
       subtitle = "A comparison between smokers and non-smokers")
```

```{r}
df_cleaned |> 
  ggplot(mapping = aes(x = BMI,
                       y = Income_Class)) +
  geom_boxplot(aes(fill = PhysActivity),
               outlier.shape = NA) +
  xlim(0,60) +
  xlab("BMI") +
  ylab("Income Class") +
  labs(title = "Comparison of BMI between different income classes", 
       subtitle = "Dependance of Physical Activity")
```
