---
title: "05_analysis_1"
author: "group22"
format:
  html:
    embed-resources: true
editor: visual
---

```{r}
df <- read_tsv("../data/03_dat_aug.tsv")
head(df)
```

```{r}
str(df)
```

```{r}
library(tidyverse)
```

```{r}
table(df$Diabetes_binary)
```

# CORRELATION

```{r}
df_numeric <- df[sapply(df, is.numeric)]
```

```{r}
# Calculate the correlation matrix for all numeric variables
cor_matrix <- cor(df_numeric, use = "pairwise.complete.obs")

# Print the correlation matrix
print("Correlation Matrix:")
print(cor_matrix)
```

```{r}
# Visualize the correlation matrix as a heatmap
library(ggplot2)
ggplot(data = as.data.frame(as.table(cor_matrix)), aes(x = Var1, y = Var2, fill = Freq)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", midpoint = 0, limit = c(-1, 1), space = "Lab", name = "Correlation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Exclude the diagonals
diag(cor_matrix) <- 0

# Identify strongly correlated pairs
strong_correlations <- subset(as.data.frame(as.table(cor_matrix)), Freq > 0.45 | Freq < -0.45)
print("Strong Correlations:")
print(strong_correlations)
```

# GENERAL MODEL WITH ALL VARIABLES

```{r}
model_all = glm(data = df_numeric,
                Diabetes_binary ~ .,
                family = binomial)
summary(model_all)
```

```{r}
# Fit a full model
full_model <- glm(Diabetes_binary ~ ., family = binomial, data = df_numeric)

# Forward selection
forward_model <- step(full_model, direction = "forward")

# Backward selection
backward_model <- step(full_model, direction = "backward")

# Display summaries
cat("Full Model Summary:\n")
summary(full_model)

cat("\nForward Selection Model Summary:\n")
summary(forward_model)

cat("\nBackward Selection Model Summary:\n")
summary(backward_model)
```
